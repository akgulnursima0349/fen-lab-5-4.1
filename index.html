<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Işık Nasıl Yayılır? - Fen Bilgisi Simülasyonu</title>
    <style>
        * {
        margin: 0;
        padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Trebuchet MS', Arial, sans-serif;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .screen {
            display: none;
            background: linear-gradient(145deg, #ffffff, #f0f8ff);
            border-radius: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            padding: 40px;
            margin: 20px 0;
            min-height: 700px;
            border: 3px solid #ff6b6b;
        }

        .screen.active {
            display: block;
            animation: bounceIn 0.8s ease-out;
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3) rotate(-10deg); }
            50% { opacity: 0.8; transform: scale(1.05) rotate(2deg); }
            100% { opacity: 1; transform: scale(1) rotate(0deg); }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .title {
            font-size: 4em;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            animation: titlePulse 2s ease-in-out infinite alternate;
        }

        @keyframes titlePulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        .subtitle {
            font-size: 1.8em;
            color: #2c3e50;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .content {
            font-size: 1.4em;
            line-height: 1.8;
            color: #2c3e50;
            margin-bottom: 40px;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
            background-size: 200% 200%;
            animation: buttonGradient 3s ease infinite;
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 30px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            margin: 15px;
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        @keyframes buttonGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 35px rgba(255, 107, 107, 0.6);
            animation: buttonBounce 0.6s ease infinite alternate;
        }

        @keyframes buttonBounce {
            from { transform: translateY(-5px) scale(1.05); }
            to { transform: translateY(-8px) scale(1.08); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-30px); }
            60% { transform: translateY(-15px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes fogMove {
            0% { transform: translateX(-10px) translateY(-5px); }
            100% { transform: translateX(10px) translateY(5px); }
        }

        @keyframes beamPulse {
            0% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.05); }
            100% { opacity: 0.3; transform: scale(1); }
        }

        @keyframes beamShine {
            0% { opacity: 0.5; transform: rotate(var(--angle, 0deg)) scaleX(0.8); }
            50% { opacity: 1; transform: rotate(var(--angle, 0deg)) scaleX(1.2); }
            100% { opacity: 0.5; transform: rotate(var(--angle, 0deg)) scaleX(0.8); }
        }

        .btn-success {
            background: linear-gradient(45deg, #27ae60, #229954);
        }

        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .interactive-area {
            background: #f8f9fa;
            border: 2px dashed #bdc3c7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 300px;
            position: relative;
        }

        .light-source {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #f1c40f, #f39c12);
            border-radius: 50%;
            position: absolute;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(241, 196, 15, 0.6);
            transition: all 0.3s ease;
        }

        .light-source:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(241, 196, 15, 0.8);
        }

        .light-beam {
            position: absolute;
            background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
            height: 4px;
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
            transform-origin: left center;
        }

        .card {
            width: 100px;
            height: 80px;
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            position: absolute;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card.hole {
            background: radial-gradient(circle, #34495e 0%, #34495e 15%, #ecf0f1 15%);
        }

        .target-screen {
            width: 120px;
            height: 100px;
            background: #2c3e50;
            border-radius: 8px;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .target-screen.lit {
            background: radial-gradient(circle, #f1c40f, #f39c12);
            color: #2c3e50;
        }

        .drag-zone {
            border: 3px dashed #3498db;
            border-radius: 10px;
            padding: 20px;
            margin: 10px;
            min-height: 100px;
            text-align: center;
            background: rgba(52, 152, 219, 0.1);
        }

        .draggable {
            display: inline-block;
            margin: 10px;
            cursor: move;
            transition: all 0.3s ease;
        }

        .draggable:hover {
            transform: scale(1.05);
        }

        .draggable img {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .quiz-question {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .quiz-option {
            background: white;
            border: 2px solid #bdc3c7;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .quiz-option.selected {
            border-color: #27ae60;
            background: #d5f4e6;
        }

        .quiz-option.correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }

        .quiz-option.incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }

        .feedback.correct {
            background: #d5f4e6;
            color: #27ae60;
            border: 2px solid #27ae60;
        }

        .feedback.incorrect {
            background: #fadbd8;
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }

        .canvas-container {
            border: 2px solid #bdc3c7;
            border-radius: 10px;
            margin: 20px 0;
            background: white;
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .slider {
            width: 200px;
            height: 6px;
            border-radius: 3px;
            background: #bdc3c7;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
        overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            width: 0%;
            transition: width 0.3s ease;
        }

        .badge {
            display: inline-block;
            padding: 8px 16px;
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 5px;
        }

        .badge.gold {
            background: linear-gradient(45deg, #f1c40f, #f39c12);
        }

        .badge.silver {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
        overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .table th, .table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .table th {
            background: #34495e;
            color: white;
            font-weight: bold;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
        }

        .nav-btn {
            padding: 12px 25px;
            font-size: 1em;
        }

        .screen-counter {
            background: #34495e;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .title {
                font-size: 2em;
            }
            
            .quiz-options {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
      }
    </style>
  </head>
  <body>
    <div class="container">
        <!-- E0: Karşılama & Hedefler -->
        <div class="screen active" id="screen-0">
            <div class="header">
                <h1 class="title">🌟 Işık Nasıl Yayılır? 🌟</h1>
                <p class="subtitle">🎓 Fen Bilgisi Etkileşimli Simülasyonu 🎓</p>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: center; margin: 40px 0;">
                <div>
                    <div class="content">
                        <p>🔬 Bu etkinlikte, bir ışık kaynağından çıkan ışığın her yönde ve doğrusal bir yol izlediğini gözlemleyecek, bulgularınızı çizim ve tablo ile kaydedeceksiniz.</p>
                        
                        <div style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); padding: 20px; border-radius: 20px; margin: 20px 0; color: white; font-weight: bold;">
                            <h3 style="margin-bottom: 15px;">🎯 Öğrenecekleriniz:</h3>
                            <ul style="list-style: none; padding: 0;">
                                <li>✨ Işık kaynaklarını tanıma</li>
                                <li>🌈 Işık demetini gözlemleme</li>
                                <li>📏 Doğrusal yayılma deneyi</li>
                                <li>🎨 Çizim ve kayıt tutma</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center;">
                    <div style="font-size: 8em; animation: rotate 3s linear infinite;">☀️</div>
                    <div style="font-size: 6em; animation: bounce 2s ease-in-out infinite;">💡</div>
                    <div style="font-size: 4em; animation: pulse 1.5s ease-in-out infinite;">🔦</div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 40px 0;">
                <button class="btn btn-success" onclick="startSimulation()" style="font-size: 1.5em; padding: 25px 50px;">🚀 Başla</button>
                <button class="btn btn-warning" onclick="showSafety()" style="font-size: 1.5em; padding: 25px 50px;">🛡️ Laboratuvar Güvenliği</button>
            </div>
        </div>

        <!-- E1: Işık Kaynaklarını Tanıyalım -->
        <div class="screen" id="screen-1">
            <div class="header">
                <h2>🌞 Işık Kaynaklarını Tanıyalım 🌞</h2>
            </div>
            
            <div class="content">
                <p>🔍 Işık kaynağı kendi ışığını üreten varlık/araçtır. Güneş doğal; ampul ve el feneri yapay ışık kaynağıdır.</p>
                <p style="color: #ff6b6b; font-weight: bold; font-size: 1.2em;">📝 Görev: Aşağıdaki ışık kaynaklarını doğru kategorilere sürükleyin!</p>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                <div class="drag-zone" id="natural-zone" style="background: linear-gradient(45deg, #96ceb4, #feca57); border: 4px dashed #27ae60; min-height: 200px; padding: 20px; border-radius: 20px;">
                    <h3 style="text-align: center; color: #2c3e50; font-size: 1.5em; margin-bottom: 20px;">🌿 Doğal Işık Kaynakları</h3>
                    <div id="natural-items" style="min-height: 150px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center;"></div>
                </div>
                
                <div class="drag-zone" id="artificial-zone" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); border: 4px dashed #e74c3c; min-height: 200px; padding: 20px; border-radius: 20px;">
                    <h3 style="text-align: center; color: #2c3e50; font-size: 1.5em; margin-bottom: 20px;">⚡ Yapay Işık Kaynakları</h3>
                    <div id="artificial-items" style="min-height: 150px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center;"></div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 20px;">🎯 Sürükleyeceğiniz Nesneler:</h3>
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
                    <div class="draggable" draggable="true" data-type="natural" style="cursor: move; transition: all 0.3s ease;">
                        <div style="width: 100px; height: 100px; background: radial-gradient(circle, #f1c40f, #f39c12); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 3em; box-shadow: 0 8px 25px rgba(241, 196, 15, 0.4); animation: pulse 2s ease-in-out infinite;">☀️</div>
                        <p style="font-weight: bold; margin-top: 10px; color: #2c3e50;">Güneş</p>
                    </div>
                    
                    <div class="draggable" draggable="true" data-type="artificial" style="cursor: move; transition: all 0.3s ease;">
                        <div style="width: 100px; height: 100px; background: linear-gradient(45deg, #34495e, #2c3e50); border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 3em; box-shadow: 0 8px 25px rgba(52, 73, 94, 0.4); animation: bounce 2s ease-in-out infinite;">💡</div>
                        <p style="font-weight: bold; margin-top: 10px; color: #2c3e50;">Ampul</p>
                    </div>
                    
                    <div class="draggable" draggable="true" data-type="artificial" style="cursor: move; transition: all 0.3s ease;">
                        <div style="width: 100px; height: 100px; background: linear-gradient(45deg, #e74c3c, #c0392b); border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 3em; box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4); animation: rotate 3s linear infinite;">🔦</div>
                        <p style="font-weight: bold; margin-top: 10px; color: #2c3e50;">El Feneri</p>
                    </div>
                </div>
            </div>
            
            <div id="feedback-1" class="feedback" style="display: none; font-size: 1.3em; font-weight: bold;"></div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">⬅️ Geri</button>
                <span class="screen-counter" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold;">1/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri ➡️</button>
            </div>
        </div>

        <!-- E2: Işık Demeti -->
        <div class="screen" id="screen-2">
            <div class="header">
                <h2>🌈 Işık Demeti Nedir? 🌈</h2>
            </div>
            
            <div class="content">
                <p>💡 Işık, bir kaynaktan çıktığında uzaya ışık ışınları (ışık demeti) gönderir. Şimdi feneri açıp demeti gözlemleyin.</p>
                <p style="color: #ff6b6b; font-weight: bold;">🔍 İpucu: Sis efekti ile ışık demetini daha net görebilirsiniz!</p>
            </div>
            
            <div class="interactive-area" style="height: 500px; background: linear-gradient(135deg, #2c3e50, #34495e); border-radius: 20px; position: relative; overflow: hidden;">
                <div class="light-source" id="flashlight" style="left: 80px; top: 250px; width: 80px; height: 80px; background: radial-gradient(circle, #f1c40f, #f39c12); border-radius: 50%; box-shadow: 0 0 30px rgba(241, 196, 15, 0.8); animation: pulse 2s ease-in-out infinite;"></div>
                <div id="light-beams" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
                <div id="fog-effect" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(ellipse at center, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 50%, transparent 100%); pointer-events: none; animation: fogMove 3s ease-in-out infinite alternate;"></div>
                <div id="light-cone" style="display: none; position: absolute; left: 120px; top: 200px; width: 0; height: 0; border-left: 200px solid transparent; border-right: 200px solid transparent; border-top: 300px solid rgba(255, 255, 255, 0.1); pointer-events: none;"></div>
            </div>
            
            <div class="controls" style="display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap;">
                <button class="btn" id="flashlight-toggle" onclick="toggleFlashlight()" style="font-size: 1.2em; padding: 15px 30px;">🔦 Fener: KAPALI</button>
                <button class="btn" id="fog-toggle" onclick="toggleFog()" style="font-size: 1.2em; padding: 15px 30px;">🌫️ Sis Efekti: KAPALI</button>
            </div>
            
            <div id="feedback-2" class="feedback" style="display: none; font-size: 1.3em; font-weight: bold; text-align: center;"></div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">⬅️ Geri</button>
                <span class="screen-counter" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold;">2/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri ➡️</button>
            </div>
        </div>

        <!-- E3: Delikli Kart Deneyi -->
        <div class="screen" id="screen-3">
            <div class="header">
                <h2>📏 Doğrusal Yayılma: Delikli Kart Deneyi 📏</h2>
            </div>
            
            <div class="content">
                <p>🔬 Delikler aynı doğru üzerinde hizalıysa ışık demeti kartların tümünden geçer. Birini kaydırırsanız ışık engellenir. Bu, ışığın doğrusal yayıldığını gösterir.</p>
                <p style="color: #ff6b6b; font-weight: bold;">🎯 Görev: Kartları sürükleyerek delikleri aynı doğru üzerinde hizalayın!</p>
            </div>
            
            <div class="interactive-area" style="height: 500px; background: linear-gradient(135deg, #2c3e50, #34495e); border-radius: 20px; position: relative; overflow: hidden;">
                <div class="light-source" id="card-light" style="left: 50px; top: 250px; width: 60px; height: 60px; background: radial-gradient(circle, #f1c40f, #f39c12); border-radius: 50%; box-shadow: 0 0 30px rgba(241, 196, 15, 0.8); animation: pulse 2s ease-in-out infinite;"></div>
                
                <div class="card hole" id="card1" style="left: 200px; top: 220px; width: 120px; height: 100px; background: linear-gradient(45deg, #ecf0f1, #bdc3c7); border: 3px solid #7f8c8d; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #2c3e50; cursor: move; box-shadow: 0 8px 25px rgba(0,0,0,0.3);">
                    <div style="width: 20px; height: 20px; background: #2c3e50; border-radius: 50%;"></div>
                    <span style="margin-left: 10px;">Kart 1</span>
                </div>
                
                <div class="card hole" id="card2" style="left: 350px; top: 220px; width: 120px; height: 100px; background: linear-gradient(45deg, #ecf0f1, #bdc3c7); border: 3px solid #7f8c8d; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #2c3e50; cursor: move; box-shadow: 0 8px 25px rgba(0,0,0,0.3);">
                    <div style="width: 20px; height: 20px; background: #2c3e50; border-radius: 50%;"></div>
                    <span style="margin-left: 10px;">Kart 2</span>
                </div>
                
                <div class="card hole" id="card3" style="left: 500px; top: 220px; width: 120px; height: 100px; background: linear-gradient(45deg, #ecf0f1, #bdc3c7); border: 3px solid #7f8c8d; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #2c3e50; cursor: move; box-shadow: 0 8px 25px rgba(0,0,0,0.3);">
                    <div style="width: 20px; height: 20px; background: #2c3e50; border-radius: 50%;"></div>
                    <span style="margin-left: 10px;">Kart 3</span>
                </div>
                
                <div class="target-screen" id="target" style="right: 50px; top: 250px; width: 150px; height: 120px; background: #2c3e50; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2em; box-shadow: 0 8px 25px rgba(0,0,0,0.3);">
                    🎯 Perde
                </div>
                
                <div id="light-path" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
                <div id="alignment-line" style="position: absolute; left: 110px; top: 270px; width: 500px; height: 2px; background: rgba(255, 255, 255, 0.3); display: none; pointer-events: none;"></div>
            </div>
            
            <div class="controls" style="display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap;">
                <button class="btn" onclick="alignCards()" style="font-size: 1.2em; padding: 15px 30px;">🎯 Hizala</button>
                <button class="btn" onclick="checkAlignment()" style="font-size: 1.2em; padding: 15px 30px;">✅ Kontrol Et</button>
                <button class="btn" onclick="showAlignmentLine()" style="font-size: 1.2em; padding: 15px 30px;">📏 Hizalama Çizgisi</button>
            </div>
            
            <div id="alignment-feedback" class="feedback" style="display: none; font-size: 1.3em; font-weight: bold; text-align: center;"></div>
            
            <div class="quiz-question" id="quiz-3" style="display: none; background: linear-gradient(45deg, #f8f9fa, #e9ecef); padding: 25px; border-radius: 20px; margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">🤔 Soru: Işığın kartlardan geçebilmesi için delikler nasıl olmalıdır?</h3>
                <div class="quiz-options" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="quiz-option" onclick="selectAnswer(this, 'A')" style="padding: 20px; font-size: 1.1em;">A) Rastgele yerlerde</div>
                    <div class="quiz-option" onclick="selectAnswer(this, 'B')" style="padding: 20px; font-size: 1.1em;">B) Aynı doğrultuda hizalı</div>
                    <div class="quiz-option" onclick="selectAnswer(this, 'C')" style="padding: 20px; font-size: 1.1em;">C) Farklı büyüklükte</div>
                    <div class="quiz-option" onclick="selectAnswer(this, 'D')" style="padding: 20px; font-size: 1.1em;">D) Kartlar kapalı</div>
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">⬅️ Geri</button>
                <span class="screen-counter" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold;">3/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri ➡️</button>
            </div>
        </div>

        <!-- E4: Kırık Pipet Analojisi -->
        <div class="screen" id="screen-4">
            <div class="header">
                <h2>🔧 Kırık Pipet Analojisi 🔧</h2>
            </div>
            
            <div class="content">
                <p>💡 Işık kırık/köşeli bir kanal izleyemez; düz yol ister. Düz pipetten geçiş olur; 'kırık' pipette ışık perdeye ulaşamaz.</p>
                <p style="color: #ff6b6b; font-weight: bold;">🎯 Görev: Farklı pipet türlerini test edin ve sonuçları gözlemleyin!</p>
            </div>
            
            <div class="interactive-area" style="height: 500px; background: linear-gradient(135deg, #2c3e50, #34495e); border-radius: 20px; position: relative; overflow: hidden;">
                <div class="light-source" id="pipe-light" style="left: 50px; top: 250px; width: 60px; height: 60px; background: radial-gradient(circle, #f1c40f, #f39c12); border-radius: 50%; box-shadow: 0 0 30px rgba(241, 196, 15, 0.8); animation: pulse 2s ease-in-out infinite;"></div>
                <div class="target-screen" id="target-4" style="right: 50px; top: 250px; width: 150px; height: 120px; background: #2c3e50; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2em; box-shadow: 0 8px 25px rgba(0,0,0,0.3);">
                    🎯 Perde
                </div>
                <div id="pipe-container" style="position: absolute; left: 150px; top: 200px; width: 400px; height: 100px;"></div>
                <div id="pipe-light-path" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
            </div>
            
            <div class="controls" style="display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap;">
                <button class="btn" onclick="selectPipe('straight')" style="font-size: 1.2em; padding: 15px 30px;">📏 Düz Pipet</button>
                <button class="btn" onclick="selectPipe('bent')" style="font-size: 1.2em; padding: 15px 30px;">🔧 Kırık Pipet</button>
                <button class="btn" onclick="resetPipe()" style="font-size: 1.2em; padding: 15px 30px;">🔄 Sıfırla</button>
            </div>
            
            <div id="pipe-feedback" class="feedback" style="display: none; font-size: 1.3em; font-weight: bold; text-align: center;"></div>
            
            <div class="quiz-question" id="quiz-4" style="display: none; background: linear-gradient(45deg, #f8f9fa, #e9ecef); padding: 25px; border-radius: 20px; margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">🤔 Soru: Işık, tek bir ortamda yol alırken kırık yolları izleyebilir.</h3>
                <div class="quiz-options" style="display: flex; justify-content: center; gap: 30px;">
                    <div class="quiz-option" onclick="selectTrueFalse(this, false)" style="padding: 20px 40px; font-size: 1.2em; background: linear-gradient(45deg, #e74c3c, #c0392b); color: white;">❌ Doğru</div>
                    <div class="quiz-option" onclick="selectTrueFalse(this, true)" style="padding: 20px 40px; font-size: 1.2em; background: linear-gradient(45deg, #27ae60, #229954); color: white;">✅ Yanlış</div>
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">⬅️ Geri</button>
                <span class="screen-counter" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold;">4/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri ➡️</button>
            </div>
        </div>

        <!-- E5: Her Yönde Yayılma -->
        <div class="screen" id="screen-5">
            <div class="header">
                <h2>🌍 Her Yönde Yayılma Gözlemi 🌍</h2>
            </div>
            
            <div class="content">
                <p>💡 Bir ışık kaynağı, çevresine her yöne ışık gönderir. Bu yüzden, kaynağa eşit uzaklıktaki her nokta ışık alır.</p>
                <p style="color: #ff6b6b; font-weight: bold;">🎯 Görev: Lamba gücünü ayarlayın ve engel ekleyerek ışık yayılımını gözlemleyin!</p>
            </div>
            
            <div class="interactive-area" style="height: 500px; background: linear-gradient(135deg, #2c3e50, #34495e); border-radius: 20px; position: relative; overflow: hidden;">
                <div class="light-source" id="central-light" style="left: 250px; top: 250px; width: 60px; height: 60px; background: radial-gradient(circle, #f1c40f, #f39c12); border-radius: 50%; box-shadow: 0 0 30px rgba(241, 196, 15, 0.8); animation: pulse 2s ease-in-out infinite;"></div>
                <div id="light-rays" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
                <div id="target-points" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
                <div id="obstacle" style="display: none; position: absolute; width: 80px; height: 80px; background: linear-gradient(45deg, #e74c3c, #c0392b); border-radius: 10px; left: 350px; top: 180px; box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4); animation: pulse 1.5s ease-in-out infinite;"></div>
                
                <!-- Hedef noktalar -->
                <div class="target-point" id="point-a" style="position: absolute; left: 150px; top: 150px; width: 30px; height: 30px; background: radial-gradient(circle, #3498db, #2980b9); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);">A</div>
                <div class="target-point" id="point-b" style="position: absolute; left: 400px; top: 150px; width: 30px; height: 30px; background: radial-gradient(circle, #27ae60, #229954); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4);">B</div>
                <div class="target-point" id="point-c" style="position: absolute; left: 150px; top: 350px; width: 30px; height: 30px; background: radial-gradient(circle, #e74c3c, #c0392b); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);">C</div>
            </div>
            
            <div class="controls" style="display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <label style="font-weight: bold; color: #2c3e50; font-size: 1.1em;">💡 Lamba Gücü: <span id="power-value">50</span>%</label>
                    <input type="range" class="slider" id="power-slider" min="0" max="100" value="50" oninput="updatePower(this.value)" style="width: 200px;">
                </div>
                <button class="btn" onclick="toggleRays()" style="font-size: 1.1em; padding: 12px 25px;">👁️ Işınları Göster/Gizle</button>
                <button class="btn" onclick="toggleObstacle()" style="font-size: 1.1em; padding: 12px 25px;">🚧 Engel Ekle/Kaldır</button>
            </div>
            
            <div class="quiz-question" id="quiz-5" style="display: none; background: linear-gradient(45deg, #f8f9fa, #e9ecef); padding: 25px; border-radius: 20px; margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">🤔 Soru: A, B, C noktalarının hangileri ışık alır?</h3>
                <div class="quiz-options" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="quiz-option" onclick="selectPoints(this, 'all')" style="padding: 20px; font-size: 1.1em;">A, B ve C</div>
                    <div class="quiz-option" onclick="selectPoints(this, 'ab')" style="padding: 20px; font-size: 1.1em;">Sadece A ve B</div>
                    <div class="quiz-option" onclick="selectPoints(this, 'bc')" style="padding: 20px; font-size: 1.1em;">Sadece B ve C</div>
                    <div class="quiz-option" onclick="selectPoints(this, 'none')" style="padding: 20px; font-size: 1.1em;">Hiçbiri</div>
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">⬅️ Geri</button>
                <span class="screen-counter" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold;">5/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri ➡️</button>
            </div>
        </div>

        <!-- E6: Gözlem Kayıtları -->
        <div class="screen" id="screen-6">
            <div class="header">
                <h2>Gözlem Kayıtları</h2>
            </div>
            
            <div class="content">
                <p>Gözlemlerinizi kaydedin. Aşağıda iki araç var: Işın Çizimi ve Veri Tablosu.</p>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div>
                    <h3>Işın Çizimi</h3>
                    <div class="canvas-container">
                        <canvas id="drawing-canvas" width="400" height="300" style="border: 1px solid #bdc3c7; cursor: crosshair;"></canvas>
                    </div>
                    <div class="controls">
                        <button class="btn" onclick="clearCanvas()">Temizle</button>
                        <button class="btn" onclick="saveDrawing()">Çizimi Kaydet</button>
                    </div>
                </div>
                
                <div>
                    <h3>Veri Tablosu</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Düzenek</th>
                                <th>Gözlem</th>
                                <th>Sonuç (Doğrusal mı?)</th>
                            </tr>
                        </thead>
                        <tbody id="data-table">
                            <tr>
                                <td>Delikli kartlar hizalı</td>
                                <td>Perde aydınlık</td>
                                <td>
                                    <select onchange="updateResult(this, 0)">
                                        <option value="">Seçiniz</option>
                                        <option value="Evet">Evet</option>
                                        <option value="Hayır">Hayır</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Kırık pipet</td>
                                <td>Perde karanlık</td>
                                <td>
                                    <select onchange="updateResult(this, 1)">
                                        <option value="">Seçiniz</option>
                                        <option value="Evet">Evet</option>
                                        <option value="Hayır">Hayır</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Her yönde yayılma</td>
                                <td>A,B,C'ye ışık ulaştı</td>
                                <td>
                                    <select onchange="updateResult(this, 2)">
                                        <option value="">Seçiniz</option>
                                        <option value="Evet">Evet</option>
                                        <option value="Hayır">Hayır</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="controls">
                        <button class="btn" onclick="exportPDF()">PDF Dışa Aktar</button>
                    </div>
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">Geri</button>
                <span class="screen-counter">6/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri</button>
            </div>
        </div>

        <!-- E7: Usta-Çırak Çizim Oyunu -->
        <div class="screen" id="screen-7">
            <div class="header">
                <h2>🎮 Usta-Çırak: Işını Çiz 🎮</h2>
            </div>
            
            <div class="content">
                <p>🎯 Perdeyi aydınlatmak için tek bir düz çizgi ile kaynaktan perdeye ışın çiz. Engel varsa ışın ulaşmayabilir.</p>
                <p style="color: #ff6b6b; font-weight: bold;">🏆 3 seviyeyi tamamlayarak "Doğrusal Yayılma Ustası" rozetini kazanın!</p>
            </div>
            
            <div class="interactive-area" style="height: 500px; background: linear-gradient(135deg, #2c3e50, #34495e); border-radius: 20px; position: relative; overflow: hidden;">
                <div class="light-source" id="game-source" style="left: 50px; top: 250px; width: 60px; height: 60px; background: radial-gradient(circle, #f1c40f, #f39c12); border-radius: 50%; box-shadow: 0 0 30px rgba(241, 196, 15, 0.8); animation: pulse 2s ease-in-out infinite;"></div>
                <div class="target-screen" id="game-target" style="right: 50px; top: 250px; width: 150px; height: 120px; background: #2c3e50; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2em; box-shadow: 0 8px 25px rgba(0,0,0,0.3);">
                    🎯 Perde
                </div>
                <div id="game-obstacle" style="display: none; position: absolute; width: 100px; height: 100px; background: linear-gradient(45deg, #e74c3c, #c0392b); border-radius: 10px; left: 300px; top: 200px; box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4); animation: pulse 1.5s ease-in-out infinite;"></div>
                <div id="game-beam" style="position: absolute; height: 4px; background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2)); border-radius: 2px; box-shadow: 0 0 15px rgba(255,255,255,0.6); display: none;"></div>
                <div id="game-drawing-area" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: crosshair;"></div>
            </div>
            
            <div class="controls" style="display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap;">
                <button class="btn" onclick="startGame()" style="font-size: 1.2em; padding: 15px 30px;">🚀 Oyunu Başlat</button>
                <button class="btn" onclick="checkGame()" style="font-size: 1.2em; padding: 15px 30px;">✅ Kontrol Et</button>
                <button class="btn" onclick="clearDrawing()" style="font-size: 1.2em; padding: 15px 30px;">🗑️ Temizle</button>
                <button class="btn" onclick="nextLevel()" style="font-size: 1.2em; padding: 15px 30px;">➡️ Sonraki Seviye</button>
            </div>
            
            <div id="game-feedback" class="feedback" style="display: none; font-size: 1.3em; font-weight: bold; text-align: center;"></div>
            <div id="game-level" style="text-align: center; margin: 20px 0; font-size: 1.4em; font-weight: bold; color: #2c3e50;"></div>
            <div id="game-score" style="text-align: center; margin: 10px 0; font-size: 1.2em; color: #7f8c8d;"></div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">⬅️ Geri</button>
                <span class="screen-counter" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold;">7/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">İleri ➡️</button>
            </div>
        </div>

        <!-- E8: Bilim Tarihi -->
        <div class="screen" id="screen-8">
            <div class="header">
                <h2>Bilim Tarihi Anı: İbnülheysem ve Karanlık Kutu</h2>
            </div>
            
            <div class="content">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: center;">
                    <div>
                        <p><strong>İbnülheysem (Alhazen)</strong>, 'karanlık oda (kutu)' düzenekleriyle ışığın doğrusal yayıldığını gösteren çalışmalarıyla optik biliminin öncülerindendir.</p>
                        <p>Simülasyonlardaki 'delikli kart' fikriyle benzer şekilde, küçük bir delikten geçen düz ışınlar, karşıda görüntü oluşturur.</p>
                    </div>
                    <div style="background: #2c3e50; padding: 20px; border-radius: 10px; color: white;">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="width: 200px; height: 150px; background: #34495e; border: 2px solid #7f8c8d; border-radius: 8px; margin: 0 auto; position: relative;">
                                <div style="position: absolute; left: 10px; top: 50%; width: 4px; height: 4px; background: #f1c40f; border-radius: 50%;"></div>
                                <div style="position: absolute; right: 20px; top: 20px; width: 60px; height: 40px; background: #f1c40f; border-radius: 4px;"></div>
                                <div style="position: absolute; left: 20px; top: 20px; right: 20px; bottom: 20px; border: 1px dashed #7f8c8d;"></div>
                            </div>
                        </div>
                        <p style="text-align: center; font-size: 0.9em;">Karanlık Kutu (Camera Obscura) Şeması</p>
                    </div>
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">Geri</button>
                <span class="screen-counter">8/10</span>
                <button class="btn nav-btn" onclick="nextScreen()">Devam Et</button>
            </div>
        </div>

        <!-- E9: Son Test & Rapor -->
        <div class="screen" id="screen-9">
            <div class="header">
                <h2>Son Test & Rapor</h2>
            </div>
            
            <div class="content">
                <p>Artık öğrendiklerinizi test etme zamanı! Aşağıdaki soruları yanıtlayın.</p>
            </div>
            
            <div id="final-test">
                <div class="quiz-question">
                    <h3>Soru 1: Işık kaynağı nedir?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'A', 0)">A) Başka yerden gelen ışığı yansıtan cisim</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'B', 0)">B) Kendi ışığını üreten varlık/araç</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'C', 0)">C) Sadece gündüz görülen cisim</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'D', 0)">D) Elektrik akımı</div>
                    </div>
                </div>
                
                <div class="quiz-question">
                    <h3>Soru 2: Delikler aynı doğru üzerinde hizalanırsa ne olur?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'A', 1)">A) Işık tüm deliklerden geçer, perde aydınlanır</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'B', 1)">B) Işık her zaman geçer</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'C', 1)">C) Işık yön değiştirir, kıvrılır</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'D', 1)">D) Perde karanlık kalır</div>
                    </div>
                </div>
                
                <div class="quiz-question">
                    <h3>Soru 3: Işık tek bir ortamda ilerlerken nasıl bir yol izler?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'A', 2)">A) Eğri</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'B', 2)">B) Düz (doğrusal)</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'C', 2)">C) Zikzak</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'D', 2)">D) Dairesel</div>
                    </div>
                </div>
                
                <div class="quiz-question">
                    <h3>Soru 4: Kaynak çevresine ışık gönderir. A, B, C noktaları eşit uzaklıkta ve engel yoksa hangileri ışık alır?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'A', 3)">A) A, B ve C</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'B', 3)">B) Sadece A</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'C', 3)">C) Sadece B ve C</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'D', 3)">D) Hiçbiri</div>
                    </div>
                </div>
                
                <div class="quiz-question">
                    <h3>Soru 5: Engel, kaynak ile nokta arasına girerse...</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'A', 4)">A) Engel yönünde ışık ulaşmaz</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'B', 4)">B) Işık engeli döner</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'C', 4)">C) Işık kıvrılır</div>
                        <div class="quiz-option" onclick="selectFinalAnswer(this, 'D', 4)">D) Işık çoğalır</div>
                    </div>
                </div>
            </div>
            
            <div id="test-results" style="display: none; text-align: center; margin: 30px 0;">
                <h3>Test Sonuçları</h3>
                <div id="score-display" style="font-size: 1.5em; margin: 20px 0;"></div>
                <div id="badges-display"></div>
                <button class="btn btn-success" onclick="generateReport()">Raporu İndir (PDF)</button>
            </div>
            
            <div class="navigation">
                <button class="btn nav-btn" onclick="previousScreen()">Geri</button>
                <span class="screen-counter">9/10</span>
                <button class="btn nav-btn" onclick="finishTest()">Testi Bitir</button>
            </div>
        </div>

        <!-- Sonuç Ekranı -->
        <div class="screen" id="screen-10">
            <div class="header">
                <h1 class="title">Tebrikler!</h1>
                <p class="subtitle">Işığın Her Yönde Doğrusal Yayıldığını Kanıtladınız</p>
            </div>
            
            <div class="content" style="text-align: center;">
                <div id="final-results"></div>
                <div style="margin: 30px 0;">
                    <button class="btn btn-success" onclick="restartSimulation()">Yeniden Başla</button>
                    <button class="btn btn-warning" onclick="generateReport()">Raporu İndir</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Güvenlik Modal -->
    <div id="safety-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSafety()">&times;</span>
            <h2>Laboratuvar Güvenliği</h2>
            <div class="content">
                <p><strong>Gerçek deneylerde dikkat edilmesi gerekenler:</strong></p>
                <ul style="margin: 20px 0; padding-left: 20px;">
                    <li>Işık kaynaklarına doğrudan bakmayın</li>
                    <li>Lazer kullanmayın</li>
                    <li>Öğretmen yönergelerini izleyin</li>
                    <li>Güvenlik gözlüğü takın</li>
                    <li>Deney sonrası ellerinizi yıkayın</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Global değişkenler
        let currentScreen = 0;
        let totalScreens = 10;
        let gameLevel = 1;
        let gameScore = 0;
        let testAnswers = [];
        let finalScore = 0;
        let isDrawing = false;
        let canvas, ctx;
        let flashlightOn = false;
        let fogOn = false;
        let powerLevel = 50;
        let showRays = true;
        let obstaclePresent = false;

        // Simülasyon başlatma
        function startSimulation() {
            showScreen(1);
        }

        // Ekran gösterme
        function showScreen(screenNumber) {
            // Tüm ekranları gizle
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Seçilen ekranı göster
            document.getElementById(`screen-${screenNumber}`).classList.add('active');
            currentScreen = screenNumber;
            
            // İlerleme çubuğunu güncelle
            updateProgress();
            
            // Ekran özel işlemler
            if (screenNumber === 2) {
                initFlashlight();
            } else if (screenNumber === 3) {
                initCards();
            } else if (screenNumber === 4) {
                initPipes();
            } else if (screenNumber === 5) {
                initRays();
            } else if (screenNumber === 6) {
                initCanvas();
            } else if (screenNumber === 7) {
                initGame();
            }
        }

        // İlerleme çubuğu
        function updateProgress() {
            const progress = (currentScreen / totalScreens) * 100;
            // İlerleme çubuğu varsa güncelle
            const progressBar = document.querySelector('.progress-fill');
            if (progressBar) {
                progressBar.style.width = progress + '%';
            }
        }

        // Önceki ekran
        function previousScreen() {
            if (currentScreen > 0) {
                showScreen(currentScreen - 1);
            }
        }

        // Sonraki ekran
        function nextScreen() {
            if (currentScreen < totalScreens) {
                showScreen(currentScreen + 1);
            }
        }

        // Güvenlik modal
        function showSafety() {
            document.getElementById('safety-modal').style.display = 'block';
        }

        function closeSafety() {
            document.getElementById('safety-modal').style.display = 'none';
        }

        // E1: Işık kaynakları sürükle-bırak
        function initDragDrop() {
            const draggables = document.querySelectorAll('.draggable');
            const zones = document.querySelectorAll('.drag-zone');

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', draggable.dataset.type);
                    e.dataTransfer.setData('text/html', draggable.outerHTML);
                    draggable.style.opacity = '0.5';
                });

                draggable.addEventListener('dragend', (e) => {
                    draggable.style.opacity = '1';
                });
            });

            zones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.background = 'linear-gradient(45deg, #ff6b6b, #4ecdc4)';
                    zone.style.transform = 'scale(1.02)';
                });

                zone.addEventListener('dragleave', (e) => {
                    if (zone.id === 'natural-zone') {
                        zone.style.background = 'linear-gradient(45deg, #96ceb4, #feca57)';
                    } else {
                        zone.style.background = 'linear-gradient(45deg, #ff6b6b, #4ecdc4)';
                    }
                    zone.style.transform = 'scale(1)';
                });

                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const type = e.dataTransfer.getData('text/plain');
                    const html = e.dataTransfer.getData('text/html');
                    const zoneType = zone.id.includes('natural') ? 'natural' : 'artificial';
                    
                    // Zone'u eski haline getir
                    if (zone.id === 'natural-zone') {
                        zone.style.background = 'linear-gradient(45deg, #96ceb4, #feca57)';
                    } else {
                        zone.style.background = 'linear-gradient(45deg, #ff6b6b, #4ecdc4)';
                    }
                    zone.style.transform = 'scale(1)';
                    
                    if (type === zoneType) {
                        // Doğru yerleştirme - nesneyi zone içine ekle
                        const itemsContainer = zone.querySelector('div');
                        const newItem = document.createElement('div');
                        newItem.innerHTML = html;
                        newItem.style.margin = '10px';
                        newItem.style.transform = 'scale(0.8)';
                        newItem.style.animation = 'bounceIn 0.5s ease-out';
                        itemsContainer.appendChild(newItem);
                        
                        // Orijinal nesneyi gizle
                        const originalItem = document.querySelector(`[data-type="${type}"]`);
                        if (originalItem && !originalItem.closest('.drag-zone')) {
                            originalItem.style.display = 'none';
                        }
                        
                        showFeedback('correct', '🎉 Harika! Işık kaynaklarını doğru ayırt ettiniz!');
                        
                        // Tüm nesneler yerleştirildi mi kontrol et
                        setTimeout(() => {
                            checkAllPlaced();
                        }, 1000);
                    } else {
                        // Yanlış yerleştirme
                        showFeedback('incorrect', '❌ İpucu: Güneş doğal ışık kaynağıdır; ampul ve el feneri yapay ışık kaynağıdır.');
                    }
                });
            });
        }

        function checkAllPlaced() {
            const naturalItems = document.querySelectorAll('#natural-items .draggable');
            const artificialItems = document.querySelectorAll('#artificial-items .draggable');
            
            if (naturalItems.length > 0 && artificialItems.length >= 2) {
                showFeedback('correct', '🎊 Tebrikler! Tüm ışık kaynaklarını doğru kategorilere yerleştirdiniz!');
                setTimeout(() => {
                    nextScreen();
                }, 2000);
            }
        }

        // E2: El feneri
        function initFlashlight() {
            // El feneri animasyonu
        }

        function toggleFlashlight() {
            flashlightOn = !flashlightOn;
            const button = document.getElementById('flashlight-toggle');
            const flashlight = document.getElementById('flashlight');
            const beams = document.getElementById('light-beams');
            const cone = document.getElementById('light-cone');
            const feedback = document.getElementById('feedback-2');
            
            if (flashlightOn) {
                button.textContent = '🔦 Fener: AÇIK';
                button.style.background = 'linear-gradient(45deg, #27ae60, #229954)';
                flashlight.style.boxShadow = '0 0 50px rgba(241, 196, 15, 1), 0 0 100px rgba(241, 196, 15, 0.5)';
                flashlight.style.animation = 'pulse 1s ease-in-out infinite';
                createLightBeam();
                cone.style.display = 'block';
                showFeedback('correct', '🌟 Harika! Işık demetini görebiliyor musunuz?');
            } else {
                button.textContent = '🔦 Fener: KAPALI';
                button.style.background = 'linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1)';
                flashlight.style.boxShadow = '0 0 20px rgba(241, 196, 15, 0.6)';
                flashlight.style.animation = 'pulse 2s ease-in-out infinite';
                beams.innerHTML = '';
                cone.style.display = 'none';
                if (feedback) feedback.style.display = 'none';
            }
        }

        function toggleFog() {
            fogOn = !fogOn;
            const button = document.getElementById('fog-toggle');
            const fog = document.getElementById('fog-effect');
            
            if (fogOn) {
                button.textContent = '🌫️ Sis Efekti: AÇIK';
                button.style.background = 'linear-gradient(45deg, #27ae60, #229954)';
                fog.style.display = 'block';
                if (flashlightOn) {
                    showFeedback('correct', '✨ Mükemmel! Sis ile ışık demeti çok daha net görünüyor!');
                }
            } else {
                button.textContent = '🌫️ Sis Efekti: KAPALI';
                button.style.background = 'linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1)';
                fog.style.display = 'none';
            }
        }

        function createLightBeam() {
            const beams = document.getElementById('light-beams');
            beams.innerHTML = '';
            
            // Konik ışık demeti oluştur
            const cone = document.createElement('div');
            cone.style.cssText = `
                position: absolute;
                left: 120px;
                top: 200px;
                width: 0;
                height: 0;
                border-left: 200px solid transparent;
                border-right: 200px solid transparent;
                border-top: 300px solid rgba(255, 255, 255, 0.2);
                pointer-events: none;
                animation: beamPulse 2s ease-in-out infinite;
            `;
            beams.appendChild(cone);
            
            // Işık ışınları oluştur
            for (let i = 0; i < 8; i++) {
                const angle = (i / 8) * 60 - 30; // -30 ile +30 derece arası
                const beam = document.createElement('div');
                beam.style.cssText = `
                    position: absolute;
                    left: 160px;
                    top: 290px;
                    width: 200px;
                    height: 3px;
                    background: linear-gradient(90deg, rgba(255,255,255,0.9), rgba(255,255,255,0.3));
                    transform-origin: left center;
                    transform: rotate(${angle}deg);
                    box-shadow: 0 0 10px rgba(255,255,255,0.5);
                    animation: beamShine 1.5s ease-in-out infinite;
                `;
                beams.appendChild(beam);
            }
        }

        // E3: Delikli kartlar
        function initCards() {
            // Kartları sürüklenebilir yap
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.addEventListener('mousedown', startDrag);
                card.addEventListener('dragstart', (e) => e.preventDefault());
            });
        }

        function startDrag(e) {
            const card = e.target.closest('.card');
            if (!card) return;
            
            let isDragging = true;
            const startX = e.clientX - card.offsetLeft;
            const startY = e.clientY - card.offsetTop;
            
            card.style.zIndex = '1000';
            card.style.transform = 'scale(1.1)';
            card.style.boxShadow = '0 15px 35px rgba(0,0,0,0.5)';
            
            function onMouseMove(e) {
                if (isDragging) {
                    const newLeft = e.clientX - startX;
                    const newTop = e.clientY - startY;
                    card.style.left = Math.max(0, Math.min(newLeft, 800)) + 'px';
                    card.style.top = Math.max(0, Math.min(newTop, 400)) + 'px';
                }
            }
            
            function onMouseUp() {
                isDragging = false;
                card.style.zIndex = '1';
                card.style.transform = 'scale(1)';
                card.style.boxShadow = '0 8px 25px rgba(0,0,0,0.3)';
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
                checkAlignment();
            }
            
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        }

        function alignCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.left = (200 + index * 150) + 'px';
                card.style.top = '220px';
                card.style.transition = 'all 0.5s ease';
            });
            setTimeout(() => {
                checkAlignment();
            }, 600);
        }

        function showAlignmentLine() {
            const line = document.getElementById('alignment-line');
            line.style.display = line.style.display === 'none' ? 'block' : 'none';
        }

        function checkAlignment() {
            const cards = document.querySelectorAll('.card');
            const target = document.getElementById('target');
            const feedback = document.getElementById('alignment-feedback');
            const lightPath = document.getElementById('light-path');
            
            // Hizalama kontrolü - deliklerin merkezleri aynı yükseklikte mi?
            let aligned = true;
            const cardPositions = [];
            
            cards.forEach(card => {
                const rect = card.getBoundingClientRect();
                const containerRect = card.parentElement.getBoundingClientRect();
                const relativeTop = rect.top - containerRect.top;
                cardPositions.push(relativeTop);
            });
            
            // Tolerans: ±20px
            const avgTop = cardPositions.reduce((a, b) => a + b, 0) / cardPositions.length;
            cardPositions.forEach(pos => {
                if (Math.abs(pos - avgTop) > 20) {
                    aligned = false;
                }
            });
            
            // Işık yolu çiz
            lightPath.innerHTML = '';
            if (aligned) {
                // Işık yolu çiz
                const beam = document.createElement('div');
                beam.style.cssText = `
                    position: absolute;
                    left: 110px;
                    top: 270px;
                    width: 500px;
                    height: 4px;
                    background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
                    box-shadow: 0 0 15px rgba(255,255,255,0.6);
                    animation: beamShine 1s ease-in-out infinite;
                `;
                lightPath.appendChild(beam);
                
                target.style.background = 'radial-gradient(circle, #f1c40f, #f39c12)';
                target.style.color = '#2c3e50';
                target.innerHTML = '✨ Aydınlık!';
                target.style.animation = 'pulse 1s ease-in-out infinite';
                
                showFeedback('correct', '🎉 Mükemmel! Delikler hizalı → Işık geçişi var → Perde aydınlandı!');
                
                setTimeout(() => {
                    document.getElementById('quiz-3').style.display = 'block';
                }, 2000);
            } else {
                target.style.background = '#2c3e50';
                target.style.color = 'white';
                target.innerHTML = '🎯 Perde';
                target.style.animation = 'none';
                
                showFeedback('incorrect', '❌ Delikler hizalı değil → Işık engellendi → Perde karanlık kaldı.');
            }
        }

        // E4: Pipet analojisi
        function initPipes() {
            // Pipet görselleştirmesi
        }

        function selectPipe(type) {
            const container = document.getElementById('pipe-container');
            const target = document.getElementById('target-4');
            const feedback = document.getElementById('pipe-feedback');
            const lightPath = document.getElementById('pipe-light-path');
            
            container.innerHTML = '';
            lightPath.innerHTML = '';
            
            if (type === 'straight') {
                // Düz pipet
                const pipe = document.createElement('div');
                pipe.style.cssText = `
                    width: 300px;
                    height: 30px;
                    background: linear-gradient(45deg, #7f8c8d, #95a5a6);
                    border-radius: 15px;
                    position: absolute;
                    left: 50px;
                    top: 35px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    border: 3px solid #34495e;
                `;
                container.appendChild(pipe);
                
                // Işık yolu çiz
                const beam = document.createElement('div');
                beam.style.cssText = `
                    position: absolute;
                    left: 110px;
                    top: 270px;
                    width: 300px;
                    height: 4px;
                    background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
                    box-shadow: 0 0 15px rgba(255,255,255,0.6);
                    animation: beamShine 1s ease-in-out infinite;
                `;
                lightPath.appendChild(beam);
                
                target.style.background = 'radial-gradient(circle, #f1c40f, #f39c12)';
                target.style.color = '#2c3e50';
                target.innerHTML = '✨ Aydınlık!';
                target.style.animation = 'pulse 1s ease-in-out infinite';
                
                showFeedback('correct', '🎉 Düz pipet → Işık geçişi var → Perde aydınlandı!');
            } else {
                // Kırık pipet
                const pipe1 = document.createElement('div');
                pipe1.style.cssText = `
                    width: 150px;
                    height: 30px;
                    background: linear-gradient(45deg, #7f8c8d, #95a5a6);
                    border-radius: 15px;
                    position: absolute;
                    left: 50px;
                    top: 35px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    border: 3px solid #34495e;
                `;
                
                const pipe2 = document.createElement('div');
                pipe2.style.cssText = `
                    width: 30px;
                    height: 100px;
                    background: linear-gradient(45deg, #7f8c8d, #95a5a6);
                    border-radius: 15px;
                    position: absolute;
                    left: 200px;
                    top: 35px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    border: 3px solid #34495e;
                `;
                
                container.appendChild(pipe1);
                container.appendChild(pipe2);
                
                target.style.background = '#2c3e50';
                target.style.color = 'white';
                target.innerHTML = '🎯 Perde';
                target.style.animation = 'none';
                
                showFeedback('incorrect', '❌ Kırık pipet → Işık geçişi yok → Perde karanlık kaldı.');
            }
            
            setTimeout(() => {
                document.getElementById('quiz-4').style.display = 'block';
            }, 2000);
        }

        function resetPipe() {
            const container = document.getElementById('pipe-container');
            const target = document.getElementById('target-4');
            const lightPath = document.getElementById('pipe-light-path');
            const feedback = document.getElementById('pipe-feedback');
            
            container.innerHTML = '';
            lightPath.innerHTML = '';
            target.style.background = '#2c3e50';
            target.style.color = 'white';
            target.innerHTML = '🎯 Perde';
            target.style.animation = 'none';
            feedback.style.display = 'none';
        }

        // E5: Her yönde yayılma
        function initRays() {
            updateRays();
            updateTargetPoints();
        }

        function updatePower(value) {
            powerLevel = value;
            document.getElementById('power-value').textContent = value;
            updateRays();
            updateTargetPoints();
        }

        function updateRays() {
            const raysContainer = document.getElementById('light-rays');
            raysContainer.innerHTML = '';
            
            if (!showRays) return;
            
            const numRays = 12;
            const baseLength = 80 + (powerLevel / 100) * 120;
            const centerX = 280;
            const centerY = 280;
            
            for (let i = 0; i < numRays; i++) {
                const angle = (i / numRays) * 360;
                const ray = document.createElement('div');
                ray.style.cssText = `
                    position: absolute;
                    width: ${baseLength}px;
                    height: 4px;
                    background: linear-gradient(90deg, rgba(255,255,255,0.9), rgba(255,255,255,0.3));
                    left: ${centerX}px;
                    top: ${centerY}px;
                    transform-origin: left center;
                    transform: rotate(${angle}deg);
                    box-shadow: 0 0 10px rgba(255,255,255,0.6);
                    animation: beamShine 2s ease-in-out infinite;
                `;
                raysContainer.appendChild(ray);
            }
        }

        function updateTargetPoints() {
            const points = ['point-a', 'point-b', 'point-c'];
            const obstacle = document.getElementById('obstacle');
            const obstacleRect = obstacle.style.display !== 'none' ? obstacle.getBoundingClientRect() : null;
            
            points.forEach(pointId => {
                const point = document.getElementById(pointId);
                const pointRect = point.getBoundingClientRect();
                const containerRect = point.parentElement.getBoundingClientRect();
                
                // Engel kontrolü
                let isBlocked = false;
                if (obstacleRect && obstacle.style.display !== 'none') {
                    // Basit engel kontrolü
                    const pointX = pointRect.left - containerRect.left;
                    const pointY = pointRect.top - containerRect.top;
                    const obstacleX = obstacleRect.left - containerRect.left;
                    const obstacleY = obstacleRect.top - containerRect.top;
                    
                    // Engel nokta ile kaynak arasında mı?
                    if (pointX > 280 && pointX < obstacleX && pointY > 180 && pointY < 220) {
                        isBlocked = true;
                    }
                }
                
                if (isBlocked) {
                    point.style.background = 'radial-gradient(circle, #95a5a6, #7f8c8d)';
                    point.style.boxShadow = '0 4px 15px rgba(149, 165, 166, 0.2)';
                    point.style.animation = 'none';
                } else {
                    point.style.background = pointId === 'point-a' ? 'radial-gradient(circle, #3498db, #2980b9)' :
                                          pointId === 'point-b' ? 'radial-gradient(circle, #27ae60, #229954)' :
                                          'radial-gradient(circle, #e74c3c, #c0392b)';
                    point.style.boxShadow = pointId === 'point-a' ? '0 4px 15px rgba(52, 152, 219, 0.4)' :
                                           pointId === 'point-b' ? '0 4px 15px rgba(39, 174, 96, 0.4)' :
                                           '0 4px 15px rgba(231, 76, 60, 0.4)';
                    point.style.animation = 'pulse 2s ease-in-out infinite';
                }
            });
        }

        function toggleRays() {
            showRays = !showRays;
            updateRays();
        }

        function toggleObstacle() {
            obstaclePresent = !obstaclePresent;
            const obstacle = document.getElementById('obstacle');
            obstacle.style.display = obstaclePresent ? 'block' : 'none';
            updateTargetPoints();
            
            setTimeout(() => {
                document.getElementById('quiz-5').style.display = 'block';
            }, 1000);
        }

        // E6: Çizim aracı
        function initCanvas() {
            canvas = document.getElementById('drawing-canvas');
            ctx = canvas.getContext('2d');
            
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            
            // Kaynak noktası çiz
            ctx.fillStyle = '#f1c40f';
            ctx.beginPath();
            ctx.arc(50, 150, 10, 0, 2 * Math.PI);
            ctx.fill();
        }

        function startDrawing(e) {
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(e.offsetX, e.offsetY);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            ctx.lineWidth = 3;
            ctx.strokeStyle = '#f1c40f';
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Kaynak noktasını yeniden çiz
            ctx.fillStyle = '#f1c40f';
            ctx.beginPath();
            ctx.arc(50, 150, 10, 0, 2 * Math.PI);
            ctx.fill();
        }

        function saveDrawing() {
            const link = document.createElement('a');
            link.download = 'isik-cizimi.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        function updateResult(select, index) {
            // Tablo güncelleme
        }

        function exportPDF() {
            // Basit PDF raporu oluşturma
            const reportContent = `
                <html>
                <head>
                    <title>Işık Yayılımı Deney Raporu</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #2c3e50; text-align: center; }
                        h2 { color: #34495e; border-bottom: 2px solid #3498db; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #bdc3c7; padding: 10px; text-align: left; }
                        th { background: #ecf0f1; font-weight: bold; }
                        .result { background: #d5f4e6; padding: 10px; border-radius: 5px; margin: 10px 0; }
                    </style>
                </head>
                <body>
                    <h1>🌟 Işık Yayılımı Deney Raporu 🌟</h1>
                    <p><strong>Tarih:</strong> ${new Date().toLocaleDateString('tr-TR')}</p>
                    <p><strong>Öğrenci:</strong> [Öğrenci Adı]</p>
                    
                    <h2>📊 Deney Sonuçları</h2>
                    <table>
                        <tr>
                            <th>Düzenek</th>
                            <th>Gözlem</th>
                            <th>Sonuç (Doğrusal mı?)</th>
                        </tr>
                        <tr>
                            <td>Delikli kartlar hizalı</td>
                            <td>Perde aydınlık</td>
                            <td>Evet</td>
                        </tr>
                        <tr>
                            <td>Kırık pipet</td>
                            <td>Perde karanlık</td>
                            <td>Evet</td>
                        </tr>
                        <tr>
                            <td>Her yönde yayılma</td>
                            <td>A,B,C'ye ışık ulaştı</td>
                            <td>Evet</td>
                        </tr>
                    </table>
                    
                    <h2>🎯 Sonuç</h2>
                    <div class="result">
                        <p><strong>Deney sonucunda:</strong></p>
                        <ul>
                            <li>Işığın doğrusal yayıldığı gözlemlendi</li>
                            <li>Işığın her yönde yayıldığı kanıtlandı</li>
                            <li>Engel durumunda ışığın ulaşamadığı görüldü</li>
                        </ul>
                    </div>
                    
                    <h2>📝 Çizim</h2>
                    <p>[Öğrenci çizimi buraya eklenecek]</p>
                </body>
                </html>
            `;
            
            // Yeni pencerede raporu aç
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(reportContent);
            reportWindow.document.close();
            
            // Yazdırma seçeneği
            setTimeout(() => {
                reportWindow.print();
            }, 1000);
            
            showFeedback('correct', '📄 PDF raporu oluşturuldu! Yazdırma penceresi açıldı.');
        }

        // E7: Oyun
        let gameDrawing = false;
        let gameStartPoint = null;
        let gameEndPoint = null;
        let gameCanvas = null;
        let gameCtx = null;

        function initGame() {
            document.getElementById('game-level').textContent = `🎮 Seviye ${gameLevel}`;
            document.getElementById('game-score').textContent = `🏆 Puan: ${gameScore}/3`;
            
            // Çizim alanını hazırla
            const drawingArea = document.getElementById('game-drawing-area');
            drawingArea.innerHTML = '';
            
            gameCanvas = document.createElement('canvas');
            gameCanvas.width = drawingArea.offsetWidth;
            gameCanvas.height = drawingArea.offsetHeight;
            gameCanvas.style.position = 'absolute';
            gameCanvas.style.top = '0';
            gameCanvas.style.left = '0';
            gameCanvas.style.pointerEvents = 'auto';
            gameCanvas.style.cursor = 'crosshair';
            drawingArea.appendChild(gameCanvas);
            
            gameCtx = gameCanvas.getContext('2d');
            gameCtx.strokeStyle = '#f1c40f';
            gameCtx.lineWidth = 4;
            gameCtx.lineCap = 'round';
            
            // Mouse olayları
            gameCanvas.addEventListener('mousedown', startGameDrawing);
            gameCanvas.addEventListener('mousemove', drawGameLine);
            gameCanvas.addEventListener('mouseup', endGameDrawing);
        }

        function startGame() {
            const obstacle = document.getElementById('game-obstacle');
            const feedback = document.getElementById('game-feedback');
            const levelText = document.getElementById('game-level');
            
            feedback.style.display = 'none';
            
            if (gameLevel === 1) {
                obstacle.style.display = 'none';
                levelText.innerHTML = '🎮 Seviye 1: <span style="color: #27ae60;">Engelsiz Yol</span>';
                showFeedback('correct', '🎯 Görev: Kaynaktan perdeye düz bir çizgi çizin!');
            } else if (gameLevel === 2) {
                obstacle.style.display = 'block';
                obstacle.style.left = '350px';
                obstacle.style.top = '200px';
                levelText.innerHTML = '🎮 Seviye 2: <span style="color: #f39c12;">Yan Engel</span>';
                showFeedback('correct', '🎯 Görev: Engel yanında, doğrudan çizgi çizin!');
            } else if (gameLevel === 3) {
                obstacle.style.display = 'block';
                obstacle.style.left = '250px';
                obstacle.style.top = '250px';
                levelText.innerHTML = '🎮 Seviye 3: <span style="color: #e74c3c;">Merkez Engel</span>';
                showFeedback('correct', '🎯 Görev: Engel tam arada! Doğrudan çizgi çizemezsiniz.');
            }
        }

        function startGameDrawing(e) {
            gameDrawing = true;
            const rect = gameCanvas.getBoundingClientRect();
            gameStartPoint = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }

        function drawGameLine(e) {
            if (!gameDrawing) return;
            
            const rect = gameCanvas.getBoundingClientRect();
            const currentPoint = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
            
            // Önceki çizgiyi temizle
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            
            // Yeni çizgiyi çiz
            gameCtx.beginPath();
            gameCtx.moveTo(gameStartPoint.x, gameStartPoint.y);
            gameCtx.lineTo(currentPoint.x, currentPoint.y);
            gameCtx.stroke();
        }

        function endGameDrawing(e) {
            if (!gameDrawing) return;
            
            gameDrawing = false;
            const rect = gameCanvas.getBoundingClientRect();
            gameEndPoint = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }

        function clearDrawing() {
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            gameStartPoint = null;
            gameEndPoint = null;
        }

        function checkGame() {
            const target = document.getElementById('game-target');
            const feedback = document.getElementById('game-feedback');
            const beam = document.getElementById('game-beam');
            
            if (!gameStartPoint || !gameEndPoint) {
                showFeedback('incorrect', '❌ Önce bir çizgi çizin!');
                return;
            }
            
            // Çizgi analizi
            const dx = gameEndPoint.x - gameStartPoint.x;
            const dy = gameEndPoint.y - gameStartPoint.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            // Engel kontrolü
            const obstacle = document.getElementById('game-obstacle');
            const obstacleRect = obstacle.getBoundingClientRect();
            const canvasRect = gameCanvas.getBoundingClientRect();
            
            let isObstacleBlocking = false;
            if (obstacle.style.display !== 'none') {
                const obstacleX = obstacleRect.left - canvasRect.left;
                const obstacleY = obstacleRect.top - canvasRect.top;
                const obstacleWidth = obstacleRect.width;
                const obstacleHeight = obstacleRect.height;
                
                // Basit çizgi-engel kesişim kontrolü
                if (gameStartPoint.x < obstacleX + obstacleWidth && 
                    gameEndPoint.x > obstacleX &&
                    gameStartPoint.y < obstacleY + obstacleHeight && 
                    gameEndPoint.y > obstacleY) {
                    isObstacleBlocking = true;
                }
            }
            
            // Sonuç değerlendirmesi
            if (gameLevel === 1) {
                // Seviye 1: Engel yok, doğrudan çizgi olmalı
                if (!isObstacleBlocking && length > 200) {
                    target.style.background = 'radial-gradient(circle, #f1c40f, #f39c12)';
                    target.style.color = '#2c3e50';
                    target.innerHTML = '✨ Aydınlık!';
                    target.style.animation = 'pulse 1s ease-in-out infinite';
                    showFeedback('correct', '🎉 Mükemmel! Doğrudan çizgi ile perdeyi aydınlattınız!');
                    gameScore++;
                } else {
                    showFeedback('incorrect', '❌ Daha uzun ve doğrudan bir çizgi çizin!');
                }
            } else if (gameLevel === 2) {
                // Seviye 2: Engel yanında, doğrudan çizgi olmalı
                if (!isObstacleBlocking && length > 200) {
                    target.style.background = 'radial-gradient(circle, #f1c40f, #f39c12)';
                    target.style.color = '#2c3e50';
                    target.innerHTML = '✨ Aydınlık!';
                    target.style.animation = 'pulse 1s ease-in-out infinite';
                    showFeedback('correct', '🎉 Harika! Engel yanında doğrudan çizgi çizdiniz!');
                    gameScore++;
                } else {
                    showFeedback('incorrect', '❌ Engel yanında doğrudan çizgi çizin!');
                }
            } else if (gameLevel === 3) {
                // Seviye 3: Engel tam arada, çizgi ulaşamaz
                if (isObstacleBlocking) {
                    target.style.background = '#2c3e50';
                    target.style.color = 'white';
                    target.innerHTML = '🎯 Perde';
                    target.style.animation = 'none';
                    showFeedback('correct', '🎉 Doğru! Engel tam arada olduğu için ışın ulaşamadı!');
                    gameScore++;
                } else {
                    showFeedback('incorrect', '❌ Engel tam arada! Çizgi engeli geçemez.');
                }
            }
            
            // Işık yolu göster
            if (gameStartPoint && gameEndPoint) {
                beam.style.display = 'block';
                beam.style.left = Math.min(gameStartPoint.x, gameEndPoint.x) + 'px';
                beam.style.top = Math.min(gameStartPoint.y, gameEndPoint.y) + 'px';
                beam.style.width = Math.abs(gameEndPoint.x - gameStartPoint.x) + 'px';
                beam.style.transform = `rotate(${angle}deg)`;
                beam.style.transformOrigin = 'left center';
            }
        }

        function nextLevel() {
            if (gameLevel < 3) {
                gameLevel++;
                document.getElementById('game-level').textContent = `🎮 Seviye ${gameLevel}`;
                document.getElementById('game-score').textContent = `🏆 Puan: ${gameScore}/3`;
                clearDrawing();
                startGame();
            } else {
                // Oyun bitti
                const feedback = document.getElementById('game-feedback');
                if (gameScore >= 2) {
                    showFeedback('correct', '🏆 Tebrikler! Doğrusal Yayılma: Usta rozeti kazandınız!');
                } else {
                    showFeedback('incorrect', '🥉 Doğrusal Yayılma: Temel rozeti kazandınız.');
                }
            }
        }

        // Quiz fonksiyonları
        function selectAnswer(element, answer) {
            // Seçenekleri temizle
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Seçili olanı işaretle
            element.classList.add('selected');
            
            // Doğru yanıt kontrolü
            const correctAnswer = 'B';
            if (answer === correctAnswer) {
                element.classList.add('correct');
                showFeedback('correct', 'Evet! Doğrusal yayılma için hizalama şart.');
            } else {
                element.classList.add('incorrect');
                showFeedback('incorrect', 'Tekrar bakın: Delikleri aynı çizgi üzerinde tuttuğunuzda perde aydınlanmıştı.');
            }
        }

        function selectTrueFalse(element, isCorrect) {
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            if (isCorrect) {
                element.classList.add('correct');
                showFeedback('correct', 'Doğru! Işık kırık yolları izleyemez.');
            } else {
                element.classList.add('incorrect');
                showFeedback('incorrect', 'Bu simülasyonda gördüğünüz gibi düz yol gerekiyor.');
            }
        }

        function selectPoints(element, answer) {
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            const correctAnswer = obstaclePresent ? 'ab' : 'all';
            if (answer === correctAnswer) {
                element.classList.add('correct');
                showFeedback('correct', 'Doğru! Kaynak her yönde yayılır.');
            } else {
                element.classList.add('incorrect');
                showFeedback('incorrect', 'Kaynak her yönde yayılır; ancak engel araya girerse o yönde ulaşmaz.');
            }
        }

        // Final test
        function selectFinalAnswer(element, answer, questionIndex) {
            // Seçenekleri temizle
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            element.classList.add('selected');
            testAnswers[questionIndex] = answer;
            
            // Doğru cevabı göster
            const correctAnswers = ['B', 'A', 'B', 'A', 'A'];
            const correctAnswer = correctAnswers[questionIndex];
            
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                const optionText = opt.textContent.trim();
                if (optionText.includes(correctAnswer + ')')) {
                    opt.classList.add('correct');
                } else if (opt.classList.contains('selected') && answer !== correctAnswer) {
                    opt.classList.add('incorrect');
                }
            });
            
            // Geri bildirim göster
            if (answer === correctAnswer) {
                showFeedback('correct', '🎉 Doğru cevap!');
            } else {
                showFeedback('incorrect', '❌ Yanlış cevap. Doğru cevap işaretlendi.');
            }
        }

        function finishTest() {
            // Test sonuçlarını hesapla
            const correctAnswers = ['B', 'A', 'B', 'A', 'A'];
            let score = 0;
            
            testAnswers.forEach((answer, index) => {
                if (answer === correctAnswers[index]) {
                    score++;
                }
            });
            
            finalScore = score;
            const percentage = (score / 5) * 100;
            
            document.getElementById('test-results').style.display = 'block';
            document.getElementById('score-display').innerHTML = `
                <div style="font-size: 2em; color: #27ae60; margin: 20px 0;">
                    ${score}/5 Doğru (${percentage}%)
                </div>
                <div style="font-size: 1.2em; color: #2c3e50; margin: 20px 0;">
                    <p><strong>Doğru Cevaplar:</strong></p>
                    <ul style="text-align: left; display: inline-block;">
                        <li>1. B) Kendi ışığını üreten varlık/araç</li>
                        <li>2. A) Işık tüm deliklerden geçer, perde aydınlanır</li>
                        <li>3. B) Düz (doğrusal)</li>
                        <li>4. A) A, B ve C</li>
                        <li>5. A) Engel yönünde ışık ulaşmaz</li>
                    </ul>
                </div>
            `;
            
            const badges = document.getElementById('badges-display');
            if (score >= 4) {
                badges.innerHTML = '<div class="badge gold">🏆 Doğrusal Yayılma: Usta</div>';
            } else if (score >= 3) {
                badges.innerHTML = '<div class="badge silver">🥈 Doğrusal Yayılma: Temel</div>';
            } else {
                badges.innerHTML = '<div class="badge" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">🥉 Daha fazla çalışma gerekli</div>';
            }
            
            showScreen(10);
        }

        function generateReport() {
            alert('PDF raporu oluşturuluyor...');
            // PDF oluşturma işlemi
        }

        function restartSimulation() {
            currentScreen = 0;
            gameLevel = 1;
            gameScore = 0;
            testAnswers = [];
            finalScore = 0;
            showScreen(0);
        }

        // Geri bildirim gösterme
        function showFeedback(type, message) {
            const feedback = document.querySelector('.feedback:not([style*="display: none"])') || 
                           document.querySelector('.feedback');
            
            if (feedback) {
                feedback.className = `feedback ${type}`;
                feedback.textContent = message;
                feedback.style.display = 'block';
                
                setTimeout(() => {
                    feedback.style.display = 'none';
                }, 3000);
            }
        }

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            initDragDrop();
            updateProgress();
        });

        // Modal dışına tıklama
        window.onclick = function(event) {
            const modal = document.getElementById('safety-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
  </body>
</html>
