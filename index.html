<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Işığın Dünyası Simülasyonu</title>
<style>
  body { font-family: Arial, sans-serif; background: #f0f8ff; margin:0; padding:0; }
  .screen { display: none; padding: 20px; text-align: center; }
  .active { display: block; }
  h1,h2,h3 { color: #222; }
  button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; border-radius: 5px; }
  #fenerContainer { position: relative; width: 400px; height: 300px; margin: 20px auto; background: #222; border-radius: 10px; }
  .beam { position: absolute; width: 2px; height: 100px; background: yellow; transform-origin: top; }
  #sis { position: absolute; width: 100%; height: 100%; background: rgba(255,255,255,0.2); display: none; top:0; left:0; border-radius: 10px; }
  .dragImg { cursor: grab; }
  .dropBox { display:inline-block; width:100px;height:100px;border:2px dashed #555; vertical-align: top; line-height:100px; font-weight:bold; color:#333; margin: 0 10px;}
  canvas { border:1px solid #aaa; background:#fff; margin-top:20px; }
  table { margin:20px auto; border-collapse: collapse; }
  table, th, td { border:1px solid #333; padding:5px 10px; }
  th { background:#ddd; }
  .badge { display:inline-block; padding:5px 10px; margin:5px; background: gold; border-radius:5px; font-weight:bold; }
</style>
</head>
<body>

<!-- E0 Karşılama -->
<div id="E0" class="screen active">
  <h1>Işık Nasıl Yayılır?</h1>
  <p>Bu etkinlikte, bir ışık kaynağından çıkan ışığın her yönde ve doğrusal bir yol izlediğini gözlemleyecek, bulgularınızı çizim ve tablo ile kaydedeceksiniz.</p>
  <button onclick="nextScreen('E1')">Başla</button>
  <button onclick="alert('Gerçek deneylerde ışık kaynaklarına doğrudan bakmayın; lazer kullanmayın; öğretmen yönergelerini izleyin.')">Laboratuvar Güvenliği</button>
</div>

<!-- E1 Işık Kaynakları -->
<div id="E1" class="screen">
  <h2>Işık Kaynaklarını Tanıyalım</h2>
  <p>Işık kaynağı kendi ışığını üreten varlık/araçtır. Güneş doğal; ampul ve el feneri yapay ışık kaynağıdır.</p>
  <div style="display:flex; justify-content:center; gap:50px; margin:20px;">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Sun_symbol.svg/120px-Sun_symbol.svg.png" id="gunes" draggable="true" class="dragImg" width="80">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Bulb_icon.svg/80px-Bulb_icon.svg.png" id="ampul" draggable="true" class="dragImg" width="80">
  </div>
  <div style="display:flex; justify-content:center; gap:50px;">
    <div id="dogal" class="dropBox">Doğal</div>
    <div id="yapay" class="dropBox">Yapay</div>
  </div>
  <button onclick="nextScreen('E2')">Sonraki</button>
</div>

<!-- E2 Işık Demeti -->
<div id="E2" class="screen">
  <h2>Işık Demeti</h2>
  <p>Feneri açıp demeti gözlemleyin. İpucu: Sis ekleyin.</p>
  <div id="fenerContainer">
    <div id="beam" class="beam" style="top:50px; left:198px; height:0;"></div>
    <div id="sis"></div>
  </div>
  <button onclick="toggleFener()">Fener: OFF/ON</button>
  <button onclick="toggleSis()">Sis Efekti: OFF/ON</button>
  <br><button onclick="nextScreen('E3')">Sonraki</button>
</div>

<!-- E3 Delikli Kart -->
<div id="E3" class="screen">
  <h2>Delikli Kart Deneyi</h2>
  <p>Delikler aynı doğru üzerinde hizalıysa ışık kartların tümünden geçer. Kartları sürükleyerek hizalayın.</p>
  <div id="kartContainer" style="display:flex; justify-content:center; gap:30px; margin:20px;">
    <div class="kart" style="width:50px;height:150px;background:#ccc; position:relative;" draggable="true">
      <div style="width:20px;height:20px;background:black;border-radius:50%;position:absolute;top:65px;left:15px;"></div>
    </div>
    <div class="kart" style="width:50px;height:150px;background:#ccc; position:relative;" draggable="true">
      <div style="width:20px;height:20px;background:black;border-radius:50%;position:absolute;top:65px;left:15px;"></div>
    </div>
    <div class="kart" style="width:50px;height:150px;background:#ccc; position:relative;" draggable="true">
      <div style="width:20px;height:20px;background:black;border-radius:50%;position:absolute;top:65px;left:15px;"></div>
    </div>
  </div>
  <button onclick="checkKartHizalama()">Kontrol Et</button>
  <button onclick="nextScreen('E4')">Sonraki</button>
</div>

<!-- E4 Kırık/Düz Pipet -->
<div id="E4" class="screen">
  <h2>Kırık Pipet Analojisi</h2>
  <p>Işık düz yoldan gider. Düz ve kırık pipeti deneyin.</p>
  <button onclick="pipetSec('duz')">Düz Pipet</button>
  <button onclick="pipetSec('kirik')">Kırık Pipet</button>
  <div id="pipetSonuc" style="margin-top:20px;font-weight:bold;"></div>
  <button onclick="nextScreen('E5')">Sonraki</button>
</div>

<!-- E5 Her Yöne Yayılma -->
<div id="E5" class="screen">
  <h2>Her Yönde Yayılma</h2>
  <p>Bir ışık kaynağı çevresine ışık gönderir. Engel varsa ışık ulaşmaz.</p>
  <input type="range" min="0" max="100" value="50" id="lambaGucu" oninput="updateOklar()">
  <div id="okContainer" style="position:relative;width:300px;height:300px;margin:20px auto;background:#222;border-radius:50%;">
    <!-- yön okları JS ile eklenecek -->
  </div>
  <button onclick="nextScreen('E6')">Sonraki</button>
</div>

<!-- E6 Çizim ve Tablo -->
<div id="E6" class="screen">
  <h2>Gözlem Kayıtları</h2>
  <p>Çizim yapın ve tabloyu doldurun.</p>
  <canvas id="cizimCanvas" width="400" height="300"></canvas>
  <button onclick="clearCanvas()">Temizle</button>
  <button onclick="savePNG()">PNG Kaydet</button>
  <table id="veriTablo">
    <tr><th>Düzenek</th><th>Gözlem</th><th>Sonuç (Doğrusal mı?)</th></tr>
    <tr><td>Delikli Kart</td><td>Perde aydınlık</td><td><select><option>Evet</option><option>Hayır</option></select></td></tr>
    <tr><td>Kırık Pipet</td><td>Perde karanlık</td><td><select><option>Evet</option><option>Hayır</option></select></td></tr>
    <tr><td>Her Yöne Yayılma</td><td>A,B,C’ye ışık ulaştı</td><td><select><option>Evet</option><option>Hayır</option></select></td></tr>
  </table>
  <button onclick="nextScreen('E7')">Sonraki</button>
</div>

<!-- E7 Mini Oyun -->
<div id="E7" class="screen">
  <h2>Usta-Çırak: Işını Çiz</h2>
  <p>Perdeyi düz ışın ile aydınlatın.</p>
  <canvas id="oyunCanvas" width="400" height="300" style="border:1px solid #333;"></canvas>
  <div id="rozetler"></div>
  <button onclick="nextScreen('E8')">Sonraki</button>
</div>

<!-- E8 Bilim Tarihi -->
<div id="E8" class="screen">
  <h2>İbnülheysem ve Karanlık Kutu</h2>
  <p>Küçük delikten geçen düz ışınlar karşıda ters görüntü oluşturur.</p>
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/62/Camera_obscura_%28schematic%29.png" width="300">
  <br><button onclick="nextScreen('E9')">Devam Et</button>
</div>

<!-- E9 Son Test & Rapor -->
<div id="E9" class="screen">
  <h2>Son Test</h2>
  <form id="testForm">
    <p>1) Işık kaynağı nedir?</p>
    <input type="radio" name="q1" value="A"> Başka yerden gelen ışığı yansıtan cisim<br>
    <input type="radio" name="q1" value="B"> Kendi ışığını üreten varlık/araç ✅<br>
    <input type="radio" name="q1" value="C"> Sadece gündüz görülen cisim<br>
    <input type="radio" name="q1" value="D"> Elektrik akımı<br>
    <button type="button" onclick="checkTest()">Testi Bitir ve Raporu Göster</button>
  </form>
  <div id="testSonuc" style="margin-top:20px;"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Genel ekran geçişi
function nextScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// E1 Drag & Drop
const gunes = document.getElementById('gunes');
const ampul = document.getElementById('ampul');
const dogal = document.getElementById('dogal');
const yapay = document.getElementById('yapay');

[gunes, ampul].forEach(item => {
  item.addEventListener('dragstart', e => { e.dataTransfer.setData('text', e.target.id); });
});

[dogal, yapay].forEach(box => {
  box.addEventListener('dragover', e => e.preventDefault());
  box.addEventListener('drop', e => {
    const id = e.dataTransfer.getData('text');
    if((id === 'gunes' && box.id === 'dogal') || (id !== 'gunes' && box.id === 'yapay')){
      alert('Harika! Işık kaynaklarını ayırt ettiniz.');
    } else {
      alert('İpucu: Güneş kendi ışığını üretir; ampul/elfeneri elektrikle ışık üretir.');
    }
  });
});

// E2 Fener & Sis
let fenerOn = false;
let sisOn = false;
function toggleFener(){
  fenerOn = !fenerOn;
  document.getElementById('beam').style.height = fenerOn ? '200px' : '0';
}
function toggleSis(){
  sisOn = !sisOn;
  document.getElementById('sis').style.display = sisOn ? 'block' : 'none';
}

// E3 Delikli Kart Kontrol
function checkKartHizalama(){
  alert('Kartlar hizalama kontrol edildi. (Örnek: hedef perdede ışık oluştu)');
}

// E4 Pipet
function pipetSec(tip){
  const sonuc = document.getElementById('pipetSonuc');
  if(tip==='duz') sonuc.textContent = 'Perde aydınlık';
  else sonuc.textContent = 'Perde karanlık';
}

// E5 Oklar
function updateOklar(){
  const container = document.getElementById('okContainer');
  container.innerHTML='';
  const guc = document.getElementById('lambaGucu').value;
  const centerX = 150, centerY = 150;
  for(let i=0;i<8;i++){
    const angle = (i*45) * Math.PI/180;
    const length = 50 + guc;
    const x2 = centerX + length*Math.cos(angle);
    const y2 = centerY + length*Math.sin(angle);
    const line = document.createElement('div');
    line.style.position='absolute';
    line.style.width='2px';
    line.style.height=length+'px';
    line.style.background='yellow';
    line.style.transformOrigin='top';
    line.style.top=centerY+'px';
    line.style.left=centerX+'px';
    line.style.transform=`rotate(${i*45}deg)`;
    container.appendChild(line);
  }
}

// E6 Çizim
const canvas = document.getElementById('cizimCanvas');
const ctx = canvas.getContext('2d');
let drawing=false, startX=0, startY=0;
canvas.addEventListener('mousedown',e=>{drawing=true; startX=e.offsetX; startY=e.offsetY;});
canvas.addEventListener('mousemove', e=>{if(drawing){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.beginPath();ctx.moveTo(startX,startY);ctx.lineTo(e.offsetX,e.offsetY);ctx.strokeStyle='yellow';ctx.lineWidth=2;ctx.stroke();}});
canvas.addEventListener('mouseup', e=>{drawing=false;});
function clearCanvas(){ctx.clearRect(0,0,canvas.width,canvas.height);}
function savePNG(){const link=document.createElement('a'); link.download='cizim.png'; link.href=canvas.toDataURL(); link.click();}

// E7 Mini Oyun
const oyunCanvas=document.getElementById('oyunCanvas');
const oCtx=oyunCanvas.getContext('2d');
oCtx.fillStyle='black'; oCtx.fillRect(50,50,20,20); // kaynak
oCtx.fillStyle='red'; oCtx.fillRect(350,50,20,20); // hedef

// E9 Test
function checkTest(){
  const form=document.getElementById('testForm');
  let puan=0;
  if(form.q1.value==='B') puan++;
  document.getElementById('testSonuc').innerHTML='Puanınız: '+puan+'/1';
}
</script>
</body>
</html>
